<!DOCTYPE html>
<html lang="en">
<head>
  <title></title>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
  <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.2.min.js"></script>
  <script type="text/javascript" src="js/jquery-ui-1.10.3.custom.min.js"></script>
  <script type="text/javascript" src="js/jquery.imgareaselect.js"></script>
  <script type="text/javascript" src="js/html2canvas.js"></script>
<script type="text/javascript">

function preview(img, selection) {
    var scaleX = 400 / (selection.width || 1);
    var scaleY = 400 / (selection.height || 1);

    $('#tatooine + div > img').css({
        width: Math.round(scaleX * 400) + 'px',
        height: Math.round(scaleY * 400) + 'px',
        marginLeft: '-' + Math.round(scaleX * selection.x1) + 'px',
        marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
    });
}

$(document).ready(function () {
    $('<div id="container"><img src="images/tatooine.jpg" style="position: relative" /></div>')
        .css({
            float: 'left',
            position: 'relative',
            overflow: 'hidden',
            width: '400px',
            height: '400px',
			margin: '5px',
			border: '2px solid #000'
        })
        .insertAfter($('#tatooine'));

    $('#tatooine').imgAreaSelect({ aspectRatio: '1:1', onSelectChange: preview });
});

$(document).ready(function () {
jQuery( '#snap' ).click(function() {
	$('.ui-resizable-handle').css("display:none")
	html2canvas($('#container'), {
	  onrendered: function(canvas) {
	    document.body.appendChild(canvas);
	  }
	});
});
});  


$(document).ready(function () {

    $( '#yoda' ).draggable();
    $( '#darkvador' ).draggable();
    $( '#container' ).droppable();
    $( ".yoda" ).resizable({ ghost: true });
	$( ".darkvador" ).resizable();
	
	
});

</script>
  <link href="css/flick/jquery-ui-1.10.3.custom.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/imgareaselect-default.css" />
<style type="text/css">

#tatooine { width:500px;height:500px; }
.kineticjs-content{
	margin-top:-400px;
	top:0px;
}
#snap{
	background-color:#a2a2a2;
	width:150px;
	height:50px;
	color:#000;
	position:absolute;
	top:0px;
	right:0px;
}

</style>
</head>
<body>
	Sélectionner la zone de la photo à utiliser : 
<div id="tatooine"><img src="images/tatooine.jpg" style="float: left; margin-right: 10px;"></div>
<div id="yoda"><img class="yoda" src="images/yoda.png" /></div>
<div id="darkvador"><img class="darkvador" src="images/darkvador.png" /></div>

<div id="snap">screen that !</div>

</body>
</html>

